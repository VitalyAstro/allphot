

# return value of a FITS keyword name in all HDUs
fits_get_key() {
    [[ ! -r ${2%[*} ]] && die -q "fits_get_key: FITS file ${2%[*} not found"
    local value=$(listhead ${2} 2> /dev/null \
	| grep "^${1}[[:space:]]*=" \
	| cut -d '=' -f 2 \
	| awk '{print $1}' \
	| sed -e "s:'::g")
    [[ -z ${value} ]] && die -q "fits_get_key: FITS keyword ${1} not found"
    echo ${value}
}

